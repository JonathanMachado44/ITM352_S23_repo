<script src="/products.js" type="text/javascript"></script>

<script>
  //get query string
  let params = (new URL(document.location)).searchParams;
  //check if username is valid and redirect to invoice if ok
  window.onload = function () {
    if (params.has('registration_errors')) {
      var errors = JSON.parse(params.get('registration_errors'));
      let err_str = '';
      for (err in errors) {
        err_str += errors[err] + '\n';
        document.getElementById(`${err}_label`).innerHTML = `<font color="red">${errors[err]}</font>`;
      }
      alert(err_str);
    }
    if (params.has('email')) { //params searches 'email' and changes the email and fullname value textbox
        email.value = params.get('email');
        fullname.value = params.get('fullname');
      }
  }
</script>
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <title>Registration</title>
  <style>
    body {
         text-align: center;
         background: #e39c8a;
     }
     h1 {
         text-align: center;
         font-size: 36px;
         margin-top: 80px;
         margin-bottom: 20px;
     }
     h2 {
         text-align: center;
         font-size: 24px;
         margin-top: 0;
         margin-bottom: 20px;
         text-transform: uppercase;
     }
     img {
         border-radius: 70%;
         max-width: 300px;
         margin-top: 20px;
         transition: transform 0.3s ease-in-out;
     }
     img:hover {
         transform: scale(1.05);
     }
     .button {
             height: 40px;
             width: 150px;
             font-size: 18px;
             padding: 10px 20px;
             background-color: #fff;
             border: none;
             color: #070100;
             cursor: pointer;
             transition: background-color 0.3s ease;
             margin-bottom: 20px;
             font-size: 16px;
             border-radius:6px;
         }
     .button:hover {
         background-color: #020000;
         color: #fff;
     }
     ul {
   list-style-type: none;
   margin: 0;
   padding: 0;
   overflow: hidden;
   background-color: rgba(0, 0, 0, 0.285);
 }
 
 li {
   float: left;
 }
 
 li a {
   display: block;
   color: rgb(255, 255, 255);
   text-align: center;
   padding: 14px 16px;
   text-decoration: none;
 }
 
 li a:hover {
   background-color: rgb(217, 206, 206);
 }
 .form-outline {
         position: relative;
         margin-bottom: 20px;
     }
 
     .form-label {
         position: center;
         top: -10px;
         left: 20px;
         padding: 0 5px;
         color: #040100;
         font-size: 14px;
     }
     .form-control {
         width: 50%;
         padding: 10px;
         border: none;
         border-bottom: 1px solid #e39c8a;
         margin-bottom: 20px;
         font-size: 16px;
         border-radius:6px;
     }
 </style>
</head>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<body>
  <section class="vh-100 gradient-custom">
    <div class="container py-5 h-100">
      <div class="row d-flex align-items-center h-100 gradient-custom-3">
        <div class="col-12 col-md-8 col-lg-6 col-xl-5">
          <div class="card bg-dark text-white" style="border-radius: 1rem;">
            <div class="card-body p-5 text-center">

              <div class="mb-md-5 mt-md-4 pb-5">
                <h2 class="text-uppercase text-center mb-5">Create an account</h2>

                <form name="register_form" action="./register" method="POST">

                  <div class="form-outline mb-4">
                    <input placeholder="Email" type="email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$" name="email" id="email"
                      class="form-control form-control-lg" />
                    <label class="form-label" id="email_label" for="email"></label>
                  </div>

                  <div class="form-outline mb-4">
                    <input placeholder="Full Name" type="text" name="fullname" id="fullname"
                      class="form-control form-control-lg" />
                    <label class="form-label" id="fullname_label" for="fullname"></label>
                  </div>

                  <div class="form-outline mb-4">
                    <input placeholder="Password" name="password" type="password" id="password"
                      class="form-control form-control-lg" />
                    <label class="form-label" id="password_label" for="password"></label>
                  </div>
                  <script>
                    // Add an event listener for form submission
                    document.querySelector('form[name="register_form"]').addEventListener('submit', function (event) {
                      const password = document.getElementById('password').value;
                      const repeatPassword = document.getElementById('repeat_password').value;
            
                      // Check if password and repeat password match
                      if (password !== repeatPassword) {
                        alert('Passwords do not match');
                        event.preventDefault(); // Prevent form submission
                        return;
                      }
                      //IR2
                      // Check if password meets the required criteria
                      const passwordPattern = /(?=.*\d)(?=.*\W)[\w\W]{8,}/;
                      if (!passwordPattern.test(password)) {
                        alert('Password must be at least 8 characters long and contain at least one digit and one special character');
                        event.preventDefault(); // Prevent form submission
                      }
                    });
                  </script>
                  <div class="form-outline mb-4">
                    <input placeholder="Repeat your password" name="repeat_password" type="password"
                      id="repeat_password" class="form-control form-control-lg" />
                    <label class="form-label" id="repeat_password_label" for="repeat_password"></label>
                  </div>

                  <div class="d-flex justify-content-center">
                    <button type="submit" class="button">Register</button>
                  </div>

                  <p class="text-center text-muted mt-5 mb-0">Have already an account? <a href="login.html"
                      class="fw-bold text-body"><u>Login here</u></a></p>

                </form>

              </div>
            </div>
          </div>
        </div>
      </div>
  </section>
</body>

</html>